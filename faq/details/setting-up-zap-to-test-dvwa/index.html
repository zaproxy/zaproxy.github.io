<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="description" content="The world’s most widely used web app scanner. Free and open source. Actively maintained by a dedicated international team of volunteers.">
  
  <title>OWASP ZAP &ndash; Setting up ZAP to Test Damn Vulnerable Web App (DVWA)</title>

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css?family=Quicksand:500,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Istok+Web|Open+Sans:400,700|Rubik&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js"></script>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-71455536-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-71455536-1');
  </script>
  
  
  
    <link href="/main.f85a2.css" rel="stylesheet">
  
</head>
<body>
<div id="page-container">
 <div id="content-wrap">
  <header class="site-header">
    <div class="wrapper flex jc-sb ai-c">
    <div class="flex">
        <a href="/" aria-label="return to landing page" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="55px" viewBox="0 0 54.98 55"><defs><radialGradient id="a" cx="29.16" cy="29.18" r="25.82" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#4389ff"/><stop offset="1" stop-color="#00549e"/></radialGradient></defs><circle cx="29.16" cy="29.18" r="25.82" fill="url(#a)"/><path d="M2.17 10.82L22.67 2a.34.34 0 0 1 .42.12l11.08 15.74a.37.37 0 0 1-.18.57l-3 1a.37.37 0 0 0-.16.58l8.75 11a.37.37 0 0 1-.19.59l-3.79.93a.37.37 0 0 0-.2.59l12.92 16.32a.36.36 0 0 1-.44.55l-29-16.74a.37.37 0 0 1 .05-.66l3.5-1.39a.37.37 0 0 0 .07-.64l-11.78-8.5a.38.38 0 0 1 .07-.64l2.69-1.18a.37.37 0 0 0 .06-.64L2.1 11.46a.37.37 0 0 1 .07-.64z" fill="#fff"/><path d="M22.8 2a.35.35 0 0 1 .29.15l11.08 15.71a.37.37 0 0 1-.18.57l-3 1a.37.37 0 0 0-.16.58l8.75 11a.37.37 0 0 1-.19.59l-3.79.93a.37.37 0 0 0-.2.59l12.92 16.32a.37.37 0 0 1-.27.6.3.3 0 0 1-.17 0l-29-16.74a.37.37 0 0 1 .05-.66l3.5-1.39a.37.37 0 0 0 .07-.64l-11.78-8.5a.38.38 0 0 1 .07-.64l2.69-1.18a.37.37 0 0 0 .06-.64L2.1 11.46a.37.37 0 0 1 .07-.64L22.67 2a.31.31 0 0 1 .13 0m0-2a2.22 2.22 0 0 0-.91.19L1.4 9a2.32 2.32 0 0 0-.43 4l9.16 6.52-.14.06a2.34 2.34 0 0 0-.42 4L19 30.45l-.81.32a2.33 2.33 0 0 0-.3 4.17l29 16.74a2.23 2.23 0 0 0 1.15.31 2.32 2.32 0 0 0 1.8-3.76L38.48 33.82l1.41-.34A2.32 2.32 0 0 0 41.52 32a2.36 2.36 0 0 0-.38-2.2l-7.34-9.26.79-.26a2.29 2.29 0 0 0 1.48-1.46 2.36 2.36 0 0 0-.3-2.08L24.68 1a2.3 2.3 0 0 0-1.88-1z"/></svg>
        </a>
        <nav class="site-nav" role="navigation">
        <div>
            <h1>&nbsp;<a href="/">ZAP</a></h1>
        </div>
        </nav>
    </div>
    <div class="nav-content flex">
      <nav class="site-nav" role="navigation">
        <div class="hamburger-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
        </div>
        <input class="hamburger-click" aria-label="site menu" type="checkbox" />
        <ul id="primary-menu" class="flex">
          
          
            
              <li class="">
                  <a href="/" title="Home page">
                  Home
                </a>
              </li>
            
          
            
              <li class="">
                  <a href="/blog/" title="Blog page">
                  Blog
                </a>
              </li>
            
          
            
              <li class="">
                  <a href="/videos/" title="Videos page">
                  Videos
                </a>
              </li>
            
          
            
              <li class="">
                  <a href="/docs/" title="Documentation page">
                  Documentation
                </a>
              </li>
            
          
            
              <li class="">
                  <a href="/community/" title="Community page">
                  Community
                </a>
              </li>
            
          
          <li id="search-menu">
            <a class="toggler">
              <img height="20" width="20" src="/img/search.svg" />
            </a>
  
            <form data-no-csrf action="/search">
              <input type="text" name="q" placeholder="Search ..." style="width: 100%" />
            </form>
          </li>
        </ul>
      </nav>
      <div class="download-button">
        <a id="cta-download" href="/download/" class="button button--orange">Download</a>
      </div>
      <div class="social-links header-social">
        <ul class="flex ai-c no-list-style m-10 px-20">
          <li>
            <a href="https://github.com/zaproxy"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.36 18.88"><path d="M9.68 0a9.68 9.68 0 0 0-3.06 18.86c.48.09.64-.21.64-.46v-1.8C4.57 17.18 4 15.45 4 15.45A2.57 2.57 0 0 0 2.93 14c-.88-.6.07-.59.07-.59a2 2 0 0 1 1.48 1 2.06 2.06 0 0 0 2.82.8A2 2 0 0 1 7.91 14c-2.15-.29-4.41-1.12-4.41-4.83a3.72 3.72 0 0 1 1-2.59A3.53 3.53 0 0 1 4.59 4s.82-.26 2.67 1a9 9 0 0 1 4.84 0c1.9-1.25 2.66-1 2.66-1a3.49 3.49 0 0 1 .1 2.57 3.71 3.71 0 0 1 1 2.59c0 3.72-2.26 4.54-4.42 4.78a2.3 2.3 0 0 1 .67 1.79v2.67c0 .25.15.56.64.46A9.68 9.68 0 0 0 9.68 0z" fill="#00549e"/></svg></a>
          </li>
          <li>
              <a href="https://twitter.com/zaproxy"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.36 15.73"><path d="M19.36 1.86a8 8 0 0 1-2.28.63 3.94 3.94 0 0 0 1.74-2.2 7.53 7.53 0 0 1-2.52 1 4 4 0 0 0-6.77 3.59A11.29 11.29 0 0 1 1.35.73 4 4 0 0 0 2.58 6a3.91 3.91 0 0 1-1.8-.5A4 4 0 0 0 4 9.48a4 4 0 0 1-1.79.06 4 4 0 0 0 3.67 2.76A8 8 0 0 1 0 14a11.32 11.32 0 0 0 6.09 1.78A11.24 11.24 0 0 0 17.38 3.92a8.08 8.08 0 0 0 1.98-2.06z" fill="#00549e"/></svg></a>
          </li>
        </ul>
      </div>
    </div>
   

  </div>
</header>

  
<section class="bolt-header">
    <div class="wrapper py-20">
      <h1 class="text--white">Frequently Asked Questions</h1>
  </div>
</section>

<div class="wrapper py-20" data-kind="page">
    <div class="breadcrumbs">
        <a href="/faq/">FAQ</a> &gt;
        <a href="/faq/#cat-technologies-supported">Technologies Supported</a>
    </div>
    <h2>Setting up ZAP to Test Damn Vulnerable Web App (DVWA)</h2>
    <div class="flex">
      <article class="pr-30 content single-post">
          <main class="post-content">
            <p>Following the steps used to spider/scan DVWA v1.9 at <code>http://localhost/DVWA</code> using ZAP 2.4.3:</p>
<ul>
<li>Create a new authentication JavaScript/ECMAScript script [1] and replace/set the script contents with the following:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JavaScript" data-lang="JavaScript"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">authenticate</span>(<span style="color:#a6e22e">helper</span>, <span style="color:#a6e22e">paramsValues</span>, <span style="color:#a6e22e">credentials</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">loginUrl</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">paramsValues</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;Login URL&#34;</span>);
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">csrfTokenName</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">paramsValues</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;CSRF Field&#34;</span>);
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">csrfTokenValue</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">extractInputFieldValue</span>(<span style="color:#a6e22e">getPageContent</span>(<span style="color:#a6e22e">helper</span>, <span style="color:#a6e22e">loginUrl</span>), <span style="color:#a6e22e">csrfTokenName</span>);
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">postData</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">paramsValues</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;POST Data&#34;</span>);

    <span style="color:#a6e22e">postData</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">postData</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39;{%username%}&#39;</span>, encodeURIComponent(<span style="color:#a6e22e">credentials</span>.<span style="color:#a6e22e">getParam</span>(<span style="color:#e6db74">&#34;Username&#34;</span>)));
    <span style="color:#a6e22e">postData</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">postData</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39;{%password%}&#39;</span>, encodeURIComponent(<span style="color:#a6e22e">credentials</span>.<span style="color:#a6e22e">getParam</span>(<span style="color:#e6db74">&#34;Password&#34;</span>)));
    <span style="color:#a6e22e">postData</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">postData</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39;{%&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">csrfTokenName</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;%}&#39;</span>, encodeURIComponent(<span style="color:#a6e22e">csrfTokenValue</span>));

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">msg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sendAndReceive</span>(<span style="color:#a6e22e">helper</span>, <span style="color:#a6e22e">loginUrl</span>, <span style="color:#a6e22e">postData</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">msg</span>;
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getRequiredParamsNames</span>() {
    <span style="color:#66d9ef">return</span> [ <span style="color:#e6db74">&#34;Login URL&#34;</span>, <span style="color:#e6db74">&#34;CSRF Field&#34;</span>, <span style="color:#e6db74">&#34;POST Data&#34;</span> ];
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getOptionalParamsNames</span>() {
    <span style="color:#66d9ef">return</span> [];
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getCredentialsParamsNames</span>() {
    <span style="color:#66d9ef">return</span> [ <span style="color:#e6db74">&#34;Username&#34;</span>, <span style="color:#e6db74">&#34;Password&#34;</span> ];
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getPageContent</span>(<span style="color:#a6e22e">helper</span>, <span style="color:#a6e22e">url</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">msg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sendAndReceive</span>(<span style="color:#a6e22e">helper</span>, <span style="color:#a6e22e">url</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">getResponseBody</span>().<span style="color:#a6e22e">toString</span>();
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sendAndReceive</span>(<span style="color:#a6e22e">helper</span>, <span style="color:#a6e22e">url</span>, <span style="color:#a6e22e">postData</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">msg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">helper</span>.<span style="color:#a6e22e">prepareMessage</span>();

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">method</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;GET&#34;</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">postData</span>) {
        <span style="color:#a6e22e">method</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;POST&#34;</span>;
        <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">setRequestBody</span>(<span style="color:#a6e22e">postData</span>);
    }

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">requestUri</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">org</span>.<span style="color:#a6e22e">apache</span>.<span style="color:#a6e22e">commons</span>.<span style="color:#a6e22e">httpclient</span>.<span style="color:#a6e22e">URI</span>(<span style="color:#a6e22e">url</span>, <span style="color:#66d9ef">true</span>);
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">requestHeader</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">org</span>.<span style="color:#a6e22e">parosproxy</span>.<span style="color:#a6e22e">paros</span>.<span style="color:#a6e22e">network</span>.<span style="color:#a6e22e">HttpRequestHeader</span>(<span style="color:#a6e22e">method</span>, <span style="color:#a6e22e">requestUri</span>, <span style="color:#e6db74">&#34;HTTP/1.0&#34;</span>);
    <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">setRequestHeader</span>(<span style="color:#a6e22e">requestHeader</span>);

    <span style="color:#a6e22e">helper</span>.<span style="color:#a6e22e">sendAndReceive</span>(<span style="color:#a6e22e">msg</span>);

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">msg</span>;
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">extractInputFieldValue</span>(<span style="color:#a6e22e">page</span>, <span style="color:#a6e22e">fieldName</span>) {
    <span style="color:#75715e">// Rhino:
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">htmlparser</span>.<span style="color:#a6e22e">jericho</span>.<span style="color:#a6e22e">Source</span>(<span style="color:#a6e22e">page</span>);
    <span style="color:#75715e">// Nashorn:
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// var Source = Java.type(&#34;net.htmlparser.jericho.Source&#34;);
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// var src = new Source(page);
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">it</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">src</span>.<span style="color:#a6e22e">getAllElements</span>(<span style="color:#e6db74">&#39;input&#39;</span>).<span style="color:#a6e22e">iterator</span>();

    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">it</span>.<span style="color:#a6e22e">hasNext</span>()) {
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">element</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">it</span>.<span style="color:#a6e22e">next</span>();
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">getAttributeValue</span>(<span style="color:#e6db74">&#39;name&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#a6e22e">fieldName</span>) {
            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">getAttributeValue</span>(<span style="color:#e6db74">&#39;value&#39;</span>);
        }
    }
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span>;
}
</code></pre></div><ul>
<li>
<p>Create &ldquo;DVWA&rdquo; context (or edit the &ldquo;Default Context&rdquo;):</p>
<ul>
<li>Context Name: <code>DVWAv1.9</code></li>
<li>In &ldquo;Include in Context&rdquo; panel add: <code>\Qhttp://localhost/DVWA\E.*</code></li>
<li>In &ldquo;Exclude from Context&rdquo; panel add:<br>
<code>\Qhttp://localhost/DVWA/login.php\E</code>
<code>\Qhttp://localhost/DVWA/logout.php\E</code>
<code>\Qhttp://localhost/DVWA/setup.php\E</code></li>
<li>In &ldquo;Authentication&rdquo; panel, choose &ldquo;Script-Based Authentication&rdquo; [3], select the &ldquo;DVWA&rdquo; authentication script, load it and fill the fields:
Login URL: <code>http://localhost/DVWA/login.php</code>
CSRF Field: <code>user_token</code>
POST Data: <code>username={%username%}&amp;password={%password%}&amp;Login=Login&amp;user_token={%user_token%}</code>
Logged in: <code>\Q&lt;a href=&quot;logout.php&quot;&gt;Logout&lt;/a&gt;\E</code><br>
Logged Out: <code>(?:Location: [./]*login\.php)|(?:\Q&lt;form action=&quot;login.php&quot; method=&quot;post&quot;&gt;\E)</code></li>
<li>In &ldquo;Users&rdquo; panel, add the user:
User Name: <code>Administrator</code>
Username: <code>admin</code>
Password: <code>password</code></li>
<li>Close the dialogue.</li>
</ul>
</li>
<li>
<p>Verify authentication is working, create seed for the spider and configure DVWA:</p>
<ul>
<li>Enable &ldquo;Force User Mode&rdquo; [4] and access the main page (e.g. &ldquo;http://localhost/DVWA&rdquo;) while proxying through ZAP, cookies should be disabled in the browser; It should show the main page thus the authentication is working and the spider has a seed;</li>
<li>Access &ldquo;http://localhost/DVWA/security.php&rdquo; and change the &ldquo;Security Level&rdquo; to &ldquo;low&rdquo;;</li>
<li>Disable the &ldquo;Forced User Mode&rdquo; (no longer needed).</li>
<li>Exclude from the context the following URLs, to prevent the spider from changing the &ldquo;Security Level&rdquo; and the password:
<code>\Qhttp://localhost/DVWA/security.php\E</code>
<code>\Qhttp://localhost/DVWA/vulnerabilities/csrf\E.*</code></li>
</ul>
</li>
</ul>
<p>With the context and authentication set up, it&rsquo;s possible to spider/scan as user.</p>
<ul>
<li>
<p>Spider:</p>
<ul>
<li>Select &ldquo;Spider&rdquo; tab and click the button &ldquo;New Scan&rdquo;;</li>
<li>Click &ldquo;Select&hellip;&rdquo;, choose the context (e.g. &ldquo;DVWAv1.9&rdquo;) and click OK;</li>
<li>Select the user &ldquo;Administrator&rdquo; and click &ldquo;Start Scan&rdquo;;</li>
<li>Spider should start and spider as user &ldquo;Administrator&rdquo;. The spider can be run a second time to ensure that all URLs are found.</li>
</ul>
</li>
<li>
<p>Active Scan:</p>
<ul>
<li>Select &ldquo;Active Scan&rdquo; tab and click the button &ldquo;New Scan&rdquo;;</li>
<li>Click &ldquo;Select&hellip;&rdquo;, choose the context (e.g. &ldquo;DVWAv1.9&rdquo;) and click OK;</li>
<li>Select the user &ldquo;Administrator&rdquo; and click &ldquo;Start Scan&rdquo;;</li>
<li>Active scanner should start and scan as user &ldquo;Administrator&rdquo;.</li>
</ul>
</li>
</ul>
<p>Active scanner should find some issues:</p>
<ul>
<li>Cross Site Scripting (Persistent) (4)</li>
<li>Cross Site Scripting (Reflected) (6)</li>
<li>Path Traversal</li>
<li>Remote OS Command Injection</li>
<li>SQL Injection - MySQL</li>
<li>SQL Injection (2)</li>
<li>Directory Browsing (7)</li>
</ul>
<ul>
<li>Fuzzing:</li>
</ul>
<p>If you are tackling a fuzzing challenge in DVWA and need to handle CSRF tokens, the following details may be of assistance:</p>
<ul>
<li>The script works with Nashorn script engine (Java 8), if you are using Java 7 it needs some changes (the changes are mentioned in the original script).</li>
<li>The constants defined in the beginning of the file might need to be changed (e.g. SOURCE_URL to match the target server/webapp).</li>
<li>The script assumes that the message being fuzzed has a valid DVWA session.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JavaScript" data-lang="JavaScript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">SOURCE_URL</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://localhost/DVWA/vulnerabilities/brute/&#34;</span>;
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">CSRF_TOKEN_NAME</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;user_token&#34;</span>;
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">REQUEST_URI</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">org</span>.<span style="color:#a6e22e">apache</span>.<span style="color:#a6e22e">commons</span>.<span style="color:#a6e22e">httpclient</span>.<span style="color:#a6e22e">URI</span>(<span style="color:#a6e22e">SOURCE_URL</span>, <span style="color:#66d9ef">true</span>);

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">processMessage</span>(<span style="color:#a6e22e">utils</span>, <span style="color:#a6e22e">message</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">msg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">message</span>.<span style="color:#a6e22e">cloneRequest</span>();
    <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">getRequestHeader</span>().<span style="color:#a6e22e">setURI</span>(<span style="color:#a6e22e">REQUEST_URI</span>);
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">csrfTokenValue</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">extractInputFieldValue</span>(<span style="color:#a6e22e">getPageContent</span>(<span style="color:#a6e22e">utils</span>, <span style="color:#a6e22e">msg</span>), <span style="color:#a6e22e">CSRF_TOKEN_NAME</span>);

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">params</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">message</span>.<span style="color:#a6e22e">getUrlParams</span>();
    <span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">params</span>, <span style="color:#a6e22e">CSRF_TOKEN_NAME</span>, encodeURIComponent(<span style="color:#a6e22e">csrfTokenValue</span>));
    <span style="color:#a6e22e">message</span>.<span style="color:#a6e22e">getRequestHeader</span>().<span style="color:#a6e22e">setGetParams</span>(<span style="color:#a6e22e">params</span>);
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">processResult</span>(<span style="color:#a6e22e">utils</span>, <span style="color:#a6e22e">fuzzResult</span>){
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getPageContent</span>(<span style="color:#a6e22e">utils</span>, <span style="color:#a6e22e">msg</span>) {
    <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">sendMessage</span>(<span style="color:#a6e22e">msg</span>);
    <span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">addMessageToResults</span>(<span style="color:#e6db74">&#34;Refresh &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">CSRF_TOKEN_NAME</span>, <span style="color:#a6e22e">msg</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">getResponseBody</span>().<span style="color:#a6e22e">toString</span>();
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">extractInputFieldValue</span>(<span style="color:#a6e22e">page</span>, <span style="color:#a6e22e">fieldName</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">Source</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;net.htmlparser.jericho.Source&#34;</span>);
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Source</span>(<span style="color:#a6e22e">page</span>);

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">it</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">src</span>.<span style="color:#a6e22e">getAllElements</span>(<span style="color:#e6db74">&#39;input&#39;</span>).<span style="color:#a6e22e">iterator</span>();

    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">it</span>.<span style="color:#a6e22e">hasNext</span>()) {
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">element</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">it</span>.<span style="color:#a6e22e">next</span>();
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">getAttributeValue</span>(<span style="color:#e6db74">&#39;name&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#a6e22e">fieldName</span>) {
            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">getAttributeValue</span>(<span style="color:#e6db74">&#39;value&#39;</span>);
        }
    }
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span>;
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">params</span>, <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">value</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">it</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">iterator</span>();

    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">it</span>.<span style="color:#a6e22e">hasNext</span>()) {
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">param</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">it</span>.<span style="color:#a6e22e">next</span>();
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">param</span>.<span style="color:#a6e22e">getName</span>() <span style="color:#f92672">==</span> <span style="color:#a6e22e">name</span>) {
            <span style="color:#a6e22e">param</span>.<span style="color:#a6e22e">setValue</span>(<span style="color:#a6e22e">value</span>);
            <span style="color:#66d9ef">return</span>;
        }
    }
}
</code></pre></div>
          </main>
      </article>
    </div>
</div>

 </div>
  <footer class="site-footer py-20 mt-20">
  <div class="wrapper flex jc-sb">
    <div class="flex ai-c">
    <div class="footer-logo"><svg xmlns="http://www.w3.org/2000/svg" width="55px" viewBox="0 0 77.58 77.61"><path d="M49.48 21.64a3.46 3.46 0 0 1 .44 3 3.38 3.38 0 0 1-2.16 2.14l-1.17.38 10.74 13.56a3.39 3.39 0 0 1-1.83 5.41l-2 .5L68 65A37.78 37.78 0 0 0 39.85 2c-1.34 0-2.66.07-4 .2zM23.33 48.26a3.4 3.4 0 0 1 .45-6.09L25 41.7l-13.81-10a3.4 3.4 0 0 1 .62-5.86l.2-.09-5.47-3.84a37.79 37.79 0 0 0 55.32 48.6z" fill="#fff"/><path d="M67.84 69.48L49 45.59a.55.55 0 0 1 .28-.87l5.55-1.36a.58.58 0 0 0 .23-.13.48.48 0 0 0 .09-.11.62.62 0 0 0 .08-.24.58.58 0 0 0 0-.26.54.54 0 0 0-.07-.13L42.29 26.37a.75.75 0 0 1-.07-.12.55.55 0 0 1 .31-.74l4.35-1.4a.54.54 0 0 0 .26-.83L30.92.22a.5.5 0 0 0-.61-.22L.32 13a.55.55 0 0 0-.1.94l16.72 11.88a.52.52 0 0 1 .22.49.45.45 0 0 1-.09.26.48.48 0 0 1-.09.11l-.13.08-3.93 1.72a.55.55 0 0 0-.29.31v.13a.59.59 0 0 0 .22.5l8.62 6.22 8.61 6.21a.55.55 0 0 1 0 .87.57.57 0 0 1-.13.08l-5.11 2a.55.55 0 0 0-.28.75.56.56 0 0 0 .21.22l42.43 24.5a.53.53 0 0 0 .64-.79z" fill="#fff"/></svg></div>
    <div class="footer-left">
      <nav class="footer-nav">
        <ul class="flex">
        
        
          
            <li class="ml-10"><a href="/" title="Home page">Home</a></li>
          
        
          
            <li class="ml-10"><a href="/blog/" title="Blog page">Blog</a></li>
          
        
          
            <li class="ml-10"><a href="/videos/" title="Videos page">Videos</a></li>
          
        
          
            <li class="ml-10"><a href="/community/" title="Community page">Community</a></li>
          
        
          
            <li class="ml-10"><a href="/statistics/" title="Statistics page">Statistics</a></li>
          
        
        </ul>
      </nav>
      



  <div class="ml-10">
    <a href="https://github.com/zaproxy/zaproxy-website/blob/master/site/content/faq/details/setting-up-zap-to-test-dvwa.md">Edit on GitHub</a>
  </div>

    </div>
  </div>

    <div class="flex ai-c">
      <span>
      ZAP is an <a href="https://owasp.org/www-project-zap/">OWASP Flagship project</a><br>
      © Copyright 2021 the ZAP Dev Team</br>
      OWASP is a registered trademark of the OWASP Foundation, Inc.
      </span>
      <ul class="flex footer-social">
        <li>
          <a href="https://github.com/zaproxy/"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.36 18.88"><path d="M9.68 0a9.68 9.68 0 0 0-3.06 18.86c.48.09.64-.21.64-.46v-1.8C4.57 17.18 4 15.45 4 15.45A2.57 2.57 0 0 0 2.93 14c-.88-.6.07-.59.07-.59a2 2 0 0 1 1.48 1 2.06 2.06 0 0 0 2.82.8A2 2 0 0 1 7.91 14c-2.15-.29-4.41-1.12-4.41-4.83a3.72 3.72 0 0 1 1-2.59A3.53 3.53 0 0 1 4.59 4s.82-.26 2.67 1a9 9 0 0 1 4.84 0c1.9-1.25 2.66-1 2.66-1a3.49 3.49 0 0 1 .1 2.57 3.71 3.71 0 0 1 1 2.59c0 3.72-2.26 4.54-4.42 4.78a2.3 2.3 0 0 1 .67 1.79v2.67c0 .25.15.56.64.46A9.68 9.68 0 0 0 9.68 0z" fill="#00549e"/></svg></a>
        </li>
        <li>
            <a href="https://twitter.com/zaproxy"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.36 15.73"><path d="M19.36 1.86a8 8 0 0 1-2.28.63 3.94 3.94 0 0 0 1.74-2.2 7.53 7.53 0 0 1-2.52 1 4 4 0 0 0-6.77 3.59A11.29 11.29 0 0 1 1.35.73 4 4 0 0 0 2.58 6a3.91 3.91 0 0 1-1.8-.5A4 4 0 0 0 4 9.48a4 4 0 0 1-1.79.06 4 4 0 0 0 3.67 2.76A8 8 0 0 1 0 14a11.32 11.32 0 0 0 6.09 1.78A11.24 11.24 0 0 0 17.38 3.92a8.08 8.08 0 0 0 1.98-2.06z" fill="#00549e"/></svg></a>
        </li>
      </ul>
    </div>
  </div>
</footer>

  
  
    <script src="/main.f85a2.js"></script>
  
</div>
</body>
</html>
