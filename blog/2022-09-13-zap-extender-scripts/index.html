<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="description" content="Use ZAP as a web server, subscribe to internal ZAP events, and more!">
  
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.zaproxy.org/blog/2022-09-13-zap-extender-scripts/images/zapbot-extender-script-social.png"/>

<meta name="twitter:title" content="Hacking ZAP - ZAP Extender Scripts"/>
<meta name="twitter:description" content="Use ZAP as a web server, subscribe to internal ZAP events, and more!"/>

    <meta property="og:title" content="Hacking ZAP - ZAP Extender Scripts" />
<meta property="og:description" content="Use ZAP as a web server, subscribe to internal ZAP events, and more!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2022-09-13-zap-extender-scripts/" /><meta property="og:image" content="https://www.zaproxy.org/blog/2022-09-13-zap-extender-scripts/images/zapbot-extender-script-social.png" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2022-09-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-09-13T00:00:00+00:00" />

  
  <title>OWASP ZAP &ndash; Hacking ZAP - ZAP Extender Scripts</title>

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css?family=Quicksand:500,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Istok+Web|Open+Sans:400,700|Rubik&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js"></script>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-71455536-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-71455536-1');
  </script>
  
  
  
    <link href="/main.6cc7c9.css" rel="stylesheet">
  
</head>
<body>
<div id="page-container">
 <div id="content-wrap">
  <header class="site-header">
    <div class="wrapper flex jc-sb ai-c">
    <div class="flex">
        <a href="/" aria-label="return to landing page" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="55px" viewBox="0 0 54.98 55"><defs><radialGradient id="a" cx="29.16" cy="29.18" r="25.82" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#4389ff"/><stop offset="1" stop-color="#00549e"/></radialGradient></defs><circle cx="29.16" cy="29.18" r="25.82" fill="url(#a)"/><path d="M2.17 10.82L22.67 2a.34.34 0 0 1 .42.12l11.08 15.74a.37.37 0 0 1-.18.57l-3 1a.37.37 0 0 0-.16.58l8.75 11a.37.37 0 0 1-.19.59l-3.79.93a.37.37 0 0 0-.2.59l12.92 16.32a.36.36 0 0 1-.44.55l-29-16.74a.37.37 0 0 1 .05-.66l3.5-1.39a.37.37 0 0 0 .07-.64l-11.78-8.5a.38.38 0 0 1 .07-.64l2.69-1.18a.37.37 0 0 0 .06-.64L2.1 11.46a.37.37 0 0 1 .07-.64z" fill="#fff"/><path d="M22.8 2a.35.35 0 0 1 .29.15l11.08 15.71a.37.37 0 0 1-.18.57l-3 1a.37.37 0 0 0-.16.58l8.75 11a.37.37 0 0 1-.19.59l-3.79.93a.37.37 0 0 0-.2.59l12.92 16.32a.37.37 0 0 1-.27.6.3.3 0 0 1-.17 0l-29-16.74a.37.37 0 0 1 .05-.66l3.5-1.39a.37.37 0 0 0 .07-.64l-11.78-8.5a.38.38 0 0 1 .07-.64l2.69-1.18a.37.37 0 0 0 .06-.64L2.1 11.46a.37.37 0 0 1 .07-.64L22.67 2a.31.31 0 0 1 .13 0m0-2a2.22 2.22 0 0 0-.91.19L1.4 9a2.32 2.32 0 0 0-.43 4l9.16 6.52-.14.06a2.34 2.34 0 0 0-.42 4L19 30.45l-.81.32a2.33 2.33 0 0 0-.3 4.17l29 16.74a2.23 2.23 0 0 0 1.15.31 2.32 2.32 0 0 0 1.8-3.76L38.48 33.82l1.41-.34A2.32 2.32 0 0 0 41.52 32a2.36 2.36 0 0 0-.38-2.2l-7.34-9.26.79-.26a2.29 2.29 0 0 0 1.48-1.46 2.36 2.36 0 0 0-.3-2.08L24.68 1a2.3 2.3 0 0 0-1.88-1z"/></svg>
        </a>
        <nav class="site-nav" role="navigation">
        <div>
            <h1>&nbsp;<a href="/">ZAP</a></h1>
        </div>
        </nav>
    </div>
    <div class="nav-content flex">
      <nav class="site-nav" role="navigation">
        <div class="hamburger-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
        </div>
        <input class="hamburger-click" aria-label="site menu" type="checkbox" />
        <ul id="primary-menu" class="flex">
          
          
            
              <li class="">
                  <a href="/" title="Home page">
                  Home
                </a>
              </li>
            
          
            
              <li class="">
                  <a href="/blog/" title="Blog page">
                  Blog
                </a>
              </li>
            
          
            
              <li class="">
                  <a href="/videos/" title="Videos page">
                  Videos
                </a>
              </li>
            
          
            
              <li class="">
                  <a href="/docs/" title="Documentation page">
                  Documentation
                </a>
              </li>
            
          
            
              <li class="">
                  <a href="/community/" title="Community page">
                  Community
                </a>
              </li>
            
          
            
              <li class="">
                  <a href="/sponsor/" title="Sponsor page">
                  Sponsor
                </a>
              </li>
            
          
          <li id="search-menu">
            <a class="toggler" href="#">
              <img height="20" width="20" src="/img/search.svg" alt="Search icon"/>
            </a>
  
            <form data-no-csrf action="/search">
              <input type="text" name="q" placeholder="Search ..." style="width: 100%" />
            </form>
          </li>
        </ul>
      </nav>
      <div class="download-button">
        <a id="cta-download" href="/download/" class="button button--orange">Download</a>
      </div>
      <div class="social-links header-social">
        <ul class="flex ai-c no-list-style m-10 px-20">
          <li>
            <a href="https://github.com/zaproxy" aria-label="Go to ZAP's GitHub repo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.36 18.88"><path d="M9.68 0a9.68 9.68 0 0 0-3.06 18.86c.48.09.64-.21.64-.46v-1.8C4.57 17.18 4 15.45 4 15.45A2.57 2.57 0 0 0 2.93 14c-.88-.6.07-.59.07-.59a2 2 0 0 1 1.48 1 2.06 2.06 0 0 0 2.82.8A2 2 0 0 1 7.91 14c-2.15-.29-4.41-1.12-4.41-4.83a3.72 3.72 0 0 1 1-2.59A3.53 3.53 0 0 1 4.59 4s.82-.26 2.67 1a9 9 0 0 1 4.84 0c1.9-1.25 2.66-1 2.66-1a3.49 3.49 0 0 1 .1 2.57 3.71 3.71 0 0 1 1 2.59c0 3.72-2.26 4.54-4.42 4.78a2.3 2.3 0 0 1 .67 1.79v2.67c0 .25.15.56.64.46A9.68 9.68 0 0 0 9.68 0z" fill="#00549e"/></svg></a>
          </li>
          <li>
              <a href="https://twitter.com/zaproxy" aria-label="Follow ZAP on Twitter"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.36 15.73"><path d="M19.36 1.86a8 8 0 0 1-2.28.63 3.94 3.94 0 0 0 1.74-2.2 7.53 7.53 0 0 1-2.52 1 4 4 0 0 0-6.77 3.59A11.29 11.29 0 0 1 1.35.73 4 4 0 0 0 2.58 6a3.91 3.91 0 0 1-1.8-.5A4 4 0 0 0 4 9.48a4 4 0 0 1-1.79.06 4 4 0 0 0 3.67 2.76A8 8 0 0 1 0 14a11.32 11.32 0 0 0 6.09 1.78A11.24 11.24 0 0 0 17.38 3.92a8.08 8.08 0 0 0 1.98-2.06z" fill="#00549e"/></svg></a>
          </li>
        </ul>
      </div>
    </div>
   

  </div>
</header>

  

<section class="bolt-header">
  <div class="wrapper py-20">
    <h1 class="text--white">Hacking ZAP - ZAP Extender Scripts</h1>
  </div>
</section>

<div class="wrapper py-70" data-kind="page">
    <div class="flex latest-versions">
      <article class="col-2-3 pr-30 content single-post">
          <div class="breadcrumbs">
              <a href="/blog/">The ZAP Blog</a>
          </div>

          <main class="post-content">
            <section class="p-10 bg--blue-lightest mb-10 mt-10 smaller-text text--blue-dark">
              Posted <span class="post-date">Tuesday September 13, 2022</span>
              <span class="word-count fl-r"> 658 Words </span>
            </section>
            <p>I recently learnt about ZAP Extender scripts and I wish I knew about them sooner!</p>
<p>Extender scripts allow dynamically adding new functionality to ZAP while it is running.
This can include graphical elements and new API endpoints.</p>
<p>The <code>install</code> function in an Extender script is called when the script is enabled, and the <code>uninstall</code> function is called when it is disabled.</p>
<p>We will now look at a few Extender scripts to demonstrate their capabilities.
These are just examples, and how you use these scripts depends on how creative you can be!
Please note that the examples in this blog post will only work on recent ZAP versions (newer than 2.11, including weekly releases).</p>

<h1 id="use-zap-as-a-web-server">Use ZAP as a web server</h1>
<p>While ZAP is intended to be used as a forward proxy, it can also act as an HTTP web server!
This could be useful when you&rsquo;re already inside ZAP and need a mock target to test your new scan rule.
Here&rsquo;s an Extender script that starts an echo server on port 9000 with the path &ldquo;/echo&rdquo;:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">address</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">9000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">HttpResponseHeader</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;org.parosproxy.paros.network.HttpResponseHeader&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">extensionNetwork</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">control</span>.<span style="color:#a6e22e">getExtensionLoader</span>().<span style="color:#a6e22e">getExtension</span>(<span style="color:#e6db74">&#34;ExtensionNetwork&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">server</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">messageHandler</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">msg</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">overridden</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#34;/echo&#34;</span>.<span style="color:#a6e22e">equals</span>(<span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">getRequestHeader</span>().<span style="color:#a6e22e">getURI</span>().<span style="color:#a6e22e">getPath</span>())) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">setResponseHeader</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">HttpResponseHeader</span>(<span style="color:#e6db74">&#34;HTTP/1.0 200 OK&#34;</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">setResponseBody</span>(<span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">getRequestBody</span>().<span style="color:#a6e22e">toString</span>())
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">setResponseHeader</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">HttpResponseHeader</span>(<span style="color:#e6db74">&#34;HTTP/1.0 404 Not Found&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">setResponseBody</span>(<span style="color:#e6db74">&#34;The page you are trying to visit does not exist :P.&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">install</span>(<span style="color:#a6e22e">helper</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">server</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">extensionNetwork</span>.<span style="color:#a6e22e">createHttpServer</span>(<span style="color:#a6e22e">messageHandler</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">start</span>(<span style="color:#a6e22e">address</span>, <span style="color:#a6e22e">port</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">uninstall</span>(<span style="color:#a6e22e">helper</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">stop</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Copy the above code to a new Extender script and enable it.
Then try opening <code>http://localhost:9000/</code> in your browser or send it a request using the <a href="/blog/2022-05-10-the-requester-addon/">Requester</a>!</p>

<h1 id="subscribe-to-zap-events">Subscribe to ZAP Events</h1>
<p>ZAP publishes internal events which may be consumed by both Java code and scripts.
Events are published when new alerts are raised, site nodes are added, a scan has stopped, etc.
You can find a full list of the internal events published by ZAP <a href="/docs/internal-events/">on this page</a>.</p>
<p>The following script sends a notification to a Discord webhook whenever ZAP raises an alert, with some of its details.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">discordWebHookUrl</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;Replace with Discord Webhook URL&gt;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">HttpSender</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;org.parosproxy.paros.network.HttpSender&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">HttpMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;org.parosproxy.paros.network.HttpMessage&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">HttpHeader</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;org.parosproxy.paros.network.HttpHeader&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">HttpRequestHeader</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;org.parosproxy.paros.network.HttpRequestHeader&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">URI</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;org.apache.commons.httpclient.URI&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">consumer</span>(<span style="color:#a6e22e">event</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">getEventType</span>() <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;alert.added&#34;</span>) <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">print</span>(<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">getParameters</span>().<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;name&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">params</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">getParameters</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">alert</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;fields&#34;</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>            { <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Alert ðŸš©&#34;</span>, <span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;name&#34;</span>) },
</span></span><span style="display:flex;"><span>            { <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;URL&#34;</span>, <span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;`&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;uri&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;`&#34;</span> },
</span></span><span style="display:flex;"><span>            { <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Risk&#34;</span>, <span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;riskString&#34;</span>), <span style="color:#e6db74">&#34;inline&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> },
</span></span><span style="display:flex;"><span>            { <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Confidence&#34;</span>, <span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;confidenceString&#34;</span>), <span style="color:#e6db74">&#34;inline&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> }
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">body</span> <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#34;content&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;embeds&#34;</span><span style="color:#f92672">:</span> [<span style="color:#a6e22e">alert</span>] }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">body</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">body</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">requestMethod</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">HttpRequestHeader</span>.<span style="color:#a6e22e">POST</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">msg</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">HttpMessage</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">setRequestHeader</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">HttpRequestHeader</span>(<span style="color:#a6e22e">requestMethod</span>, <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">URI</span>(<span style="color:#a6e22e">discordWebHookUrl</span>, <span style="color:#66d9ef">true</span>), <span style="color:#a6e22e">HttpHeader</span>.<span style="color:#a6e22e">HTTP11</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">getRequestHeader</span>().<span style="color:#a6e22e">setHeader</span>(<span style="color:#a6e22e">HttpHeader</span>.<span style="color:#a6e22e">CONTENT_TYPE</span>, <span style="color:#a6e22e">HttpHeader</span>.<span style="color:#a6e22e">JSON_CONTENT_TYPE</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">getRequestHeader</span>().<span style="color:#a6e22e">setHeader</span>(<span style="color:#a6e22e">HttpHeader</span>.<span style="color:#a6e22e">CONTENT_LENGTH</span>, String(<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">length</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">setRequestBody</span>(<span style="color:#a6e22e">body</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sender</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">HttpSender</span>(<span style="color:#a6e22e">HttpSender</span>.<span style="color:#a6e22e">MANUAL_REQUEST_INITIATOR</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sender</span>.<span style="color:#a6e22e">sendAndReceive</span>(<span style="color:#a6e22e">msg</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">print</span>(<span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">getResponseBody</span>().<span style="color:#a6e22e">toString</span>())
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">install</span>(<span style="color:#a6e22e">helper</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">org</span>.<span style="color:#a6e22e">zaproxy</span>.<span style="color:#a6e22e">zap</span>.<span style="color:#a6e22e">ZAP</span>.<span style="color:#a6e22e">getEventBus</span>().<span style="color:#a6e22e">registerConsumer</span>(<span style="color:#a6e22e">consumer</span>, <span style="color:#e6db74">&#34;org.zaproxy.zap.extension.alert.AlertEventPublisher&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">uninstall</span>(<span style="color:#a6e22e">helper</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">org</span>.<span style="color:#a6e22e">zaproxy</span>.<span style="color:#a6e22e">zap</span>.<span style="color:#a6e22e">ZAP</span>.<span style="color:#a6e22e">getEventBus</span>().<span style="color:#a6e22e">unregisterConsumer</span>(<span style="color:#a6e22e">consumer</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="images/discord-alert-message.png" alt="An example discord message from ZAPBot that contains an alert&rsquo;s name, URL, risk, and confidence."></p>

<h1 id="other-examples">Other examples</h1>
<p>We have only scratched the surface of what is possible to do with Extender scripts.
There are many more examples available as <a href="https://github.com/zaproxy/zap-extensions/tree/main/addOns/scripts/src/main/zapHomeFiles/scripts/templates/extender">templates included in ZAP</a> as well as with the <a href="https://github.com/zaproxy/community-scripts/tree/main/extender">Community Scripts</a> add-on.</p>
<p><img src="images/zap-extender-script-templates.png" alt="Extender Script Templates"></p>

<h2 id="add-new-endpoints-to-zaps-api">Add new endpoints to ZAP&rsquo;s API <a class="header-link" href="#add-new-endpoints-to-zaps-api"><svg class="fill-current o-60 hover-accent-color-light" height="22px" viewBox="0 0 24 24" width="22px" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="currentColor"/></svg></a></h2>
<p>If you want to interact with ZAP via its API but cannot find an existing endpoint to do what you want, you could write an extender script to add that endpoint.
It could also be useful in situations when you want to return data in a format ZAP doesn&rsquo;t already support.</p>

<h2 id="add-new-gui-elements">Add new GUI elements <a class="header-link" href="#add-new-gui-elements"><svg class="fill-current o-60 hover-accent-color-light" height="22px" viewBox="0 0 24 24" width="22px" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="currentColor"/></svg></a></h2>
<p>It is also possible to add GUI elements with extender scripts.
You can add new Panels, toolbars, <code>Tools</code> menu options, and more.
For example, the <a href="https://github.com/zaproxy/zap-extensions/blob/2e11aaa68bf569c756cb0b97cb32db07b5d5ee52/addOns/scripts/src/main/zapHomeFiles/scripts/templates/extender/Copy%20as%20curl%20command%20menu.js">Copy as curl command menu.js</a> script adds a new context menu item that allows you to copy any request made by ZAP as a curl command.</p>

<h2 id="register-oast-request-handlers">Register OAST Request Handlers <a class="header-link" href="#register-oast-request-handlers"><svg class="fill-current o-60 hover-accent-color-light" height="22px" viewBox="0 0 24 24" width="22px" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="currentColor"/></svg></a></h2>
<p>If you use the <a href="/blog/2021-08-23-oast-with-owasp-zap/">OAST add-on</a> for your tests, you can register custom out-of-band request handlers using extender scripts.</p>

<h1 id="your-ideas">Your Ideas!</h1>
<p>If you create any fun new Extender scripts then please share them via the <a href="https://github.com/zaproxy/community-scripts">community-scripts repository</a>!</p>

          </main>
          <div class="next-content bg--blue-lightest p-10">
              
                Previous <a class="previous" href="/blog/2022-08-31-zap-updates-2022-august/"> ZAP Updates 2022 August</a>
              
              
                Next <a class="next" href="/blog/2022-09-14-new-platinum-supporter-jit/"> New Platinum Supporter: Jit</a>
              
          </div>
      </article>
      <aside class="col-1-3">
        <section class="post-meta">
          
          
          <div class="post-authors">
            
            
              <section class="post-author-single flex p-10">
                <div class="col-1-5">
                  
                  <img class="author-picture" src="/img/authors/akshath-kothari_400x400.jpg" />
                  
                </div>
                <div class="author-name col-4-5">
                  
                    Akshath Kothari
                  
                  
                  <a class="author-twitter" href="https://twitter.com/ricekot_">@ricekot_</a>
                  
                </div>
              </section>
          

          <h4>Table of Contents</h4>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#add-new-endpoints-to-zaps-api">Add new endpoints to ZAP&rsquo;s API</a></li>
    <li><a href="#add-new-gui-elements">Add new GUI elements</a></li>
    <li><a href="#register-oast-request-handlers">Register OAST Request Handlers</a></li>
  </ul>
</nav>

          
          <h4>Tags</h4>
          <ul id="tags">
           
           <li> <a href="/tags/hacking/">hacking</a> </li>
           
           <li> <a href="/tags/scripts/">scripts</a> </li>
           
           <li> <a href="/tags/youdontknowzap/">youdontknowzap</a> </li>
           
           <li> <a href="/tags/blog/">blog</a> </li>
           
          </ul>
          
          </div>
                    
        </section>
      </aside>
    </div>
</div>

 </div>
  <footer class="site-footer py-20 mt-20">
  <div class="wrapper flex jc-sb">
    <div class="flex ai-c">
    <div class="footer-logo"><svg xmlns="http://www.w3.org/2000/svg" width="55px" viewBox="0 0 77.58 77.61"><path d="M49.48 21.64a3.46 3.46 0 0 1 .44 3 3.38 3.38 0 0 1-2.16 2.14l-1.17.38 10.74 13.56a3.39 3.39 0 0 1-1.83 5.41l-2 .5L68 65A37.78 37.78 0 0 0 39.85 2c-1.34 0-2.66.07-4 .2zM23.33 48.26a3.4 3.4 0 0 1 .45-6.09L25 41.7l-13.81-10a3.4 3.4 0 0 1 .62-5.86l.2-.09-5.47-3.84a37.79 37.79 0 0 0 55.32 48.6z" fill="#fff"/><path d="M67.84 69.48L49 45.59a.55.55 0 0 1 .28-.87l5.55-1.36a.58.58 0 0 0 .23-.13.48.48 0 0 0 .09-.11.62.62 0 0 0 .08-.24.58.58 0 0 0 0-.26.54.54 0 0 0-.07-.13L42.29 26.37a.75.75 0 0 1-.07-.12.55.55 0 0 1 .31-.74l4.35-1.4a.54.54 0 0 0 .26-.83L30.92.22a.5.5 0 0 0-.61-.22L.32 13a.55.55 0 0 0-.1.94l16.72 11.88a.52.52 0 0 1 .22.49.45.45 0 0 1-.09.26.48.48 0 0 1-.09.11l-.13.08-3.93 1.72a.55.55 0 0 0-.29.31v.13a.59.59 0 0 0 .22.5l8.62 6.22 8.61 6.21a.55.55 0 0 1 0 .87.57.57 0 0 1-.13.08l-5.11 2a.55.55 0 0 0-.28.75.56.56 0 0 0 .21.22l42.43 24.5a.53.53 0 0 0 .64-.79z" fill="#fff"/></svg></div>
    <div class="footer-left">
      <nav class="footer-nav">
        <ul class="flex">
        
        
          
            <li class="ml-10"><a href="/" title="Home page">Home</a></li>
          
        
          
            <li class="ml-10"><a href="/blog/" title="Blog page">Blog</a></li>
          
        
          
            <li class="ml-10"><a href="/videos/" title="Videos page">Videos</a></li>
          
        
          
            <li class="ml-10"><a href="/community/" title="Community page">Community</a></li>
          
        
          
            <li class="ml-10"><a href="/sponsor/" title="Sponsor page">Sponsor</a></li>
          
        
          
            <li class="ml-10"><a href="/docs/statistics/" title="Statistics page">Statistics</a></li>
          
        
        </ul>
      </nav>
      



  <div class="ml-10">
    <a href="https://github.com/zaproxy/zaproxy-website/blob/master/site/content/blog/2022-09-13-zap-extender-scripts/index.md">Edit on GitHub</a>
  </div>

    </div>
  </div>

    <div class="flex ai-c">
      <span>
      ZAP is an <a href="https://owasp.org/www-project-zap/">OWASP Flagship project</a><br>
      Â© Copyright 2023 the ZAP Dev Team</br>
      OWASP is a registered trademark of the OWASP Foundation, Inc.
      </span>
      <ul class="flex footer-social">
        <li>
          <a href="https://github.com/zaproxy/" aria-label="Go to ZAP's GitHub repo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.36 18.88"><path d="M9.68 0a9.68 9.68 0 0 0-3.06 18.86c.48.09.64-.21.64-.46v-1.8C4.57 17.18 4 15.45 4 15.45A2.57 2.57 0 0 0 2.93 14c-.88-.6.07-.59.07-.59a2 2 0 0 1 1.48 1 2.06 2.06 0 0 0 2.82.8A2 2 0 0 1 7.91 14c-2.15-.29-4.41-1.12-4.41-4.83a3.72 3.72 0 0 1 1-2.59A3.53 3.53 0 0 1 4.59 4s.82-.26 2.67 1a9 9 0 0 1 4.84 0c1.9-1.25 2.66-1 2.66-1a3.49 3.49 0 0 1 .1 2.57 3.71 3.71 0 0 1 1 2.59c0 3.72-2.26 4.54-4.42 4.78a2.3 2.3 0 0 1 .67 1.79v2.67c0 .25.15.56.64.46A9.68 9.68 0 0 0 9.68 0z" fill="#00549e"/></svg></a>
        </li>
        <li>
            <a href="https://twitter.com/zaproxy" aria-label="Follow ZAP on Twitter"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.36 15.73"><path d="M19.36 1.86a8 8 0 0 1-2.28.63 3.94 3.94 0 0 0 1.74-2.2 7.53 7.53 0 0 1-2.52 1 4 4 0 0 0-6.77 3.59A11.29 11.29 0 0 1 1.35.73 4 4 0 0 0 2.58 6a3.91 3.91 0 0 1-1.8-.5A4 4 0 0 0 4 9.48a4 4 0 0 1-1.79.06 4 4 0 0 0 3.67 2.76A8 8 0 0 1 0 14a11.32 11.32 0 0 0 6.09 1.78A11.24 11.24 0 0 0 17.38 3.92a8.08 8.08 0 0 0 1.98-2.06z" fill="#00549e"/></svg></a>
        </li>
      </ul>
    </div>
  </div>
</footer>

  
  
    <script src="/main.237d7f.js"></script>
  
</div>
</body>
</html>
